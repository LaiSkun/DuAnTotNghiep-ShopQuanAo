<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width,initial-scale=1,maximum-scale=1"
          name="viewport">
    <title>Modern Admin Dashboard</title>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
          rel="stylesheet">
    <link crossorigin="anonymous"
          href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
          rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/order.css}">
    <link rel="stylesheet" th:href="@{/css/admin.css}">
    <link crossorigin="anonymous"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
          integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
          referrerpolicy="no-referrer" rel="stylesheet"/>
    <link href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css"
          rel="stylesheet">
</head>
<body>
<input id="menu-toggle" type="checkbox">
<div th:replace="admin/sidemenu :: div"></div>
<div class="main-content">

    <header>
        <div class="header-content">
            <label for="menu-toggle"> <span class="las la-bars"></span>
            </label>

            <div class="header-menu">
                <label for=""> <span class="las la-search"></span>
                </label>

                <div class="notify-icon">
                    <span class="las la-envelope"></span> <span class="notify">4</span>
                </div>

                <div class="notify-icon">
                    <span class="las la-bell"></span> <span class="notify">3</span>
                </div>

                <div class="user">
                    <div class="bg-img" style="background-image: url(/images/1.jpeg)"></div>

                    <span class="las la-power-off"></span> <span>Đăng xuất</span>
                </div>
            </div>
        </div>
    </header>
    <main>

        <div class="page-header">
            <h1>Quản lý đơn hàng</h1>
            <small>Quản lý / Đơn hàng</small>
        </div>

        <div class="page-content">

            <div class="analytics">

                <div class="card">
                    <div class="card-head">
                        <h2>107,200</h2>
                        <span class="las la-user-friends"></span>
                    </div>
                    <div class="card-progress">
                        <small>Hoạt động người dùng trong tháng</small>
                        <div class="card-indicator">
                            <div class="indicator one" style="width: 60%"></div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-head">
                        <h2>340,230</h2>
                        <span class="las la-eye"></span>
                    </div>
                    <div class="card-progress">
                        <small>Lượt xem</small>
                        <div class="card-indicator">
                            <div class="indicator two" style="width: 80%"></div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-head">
                        <h2>$653,200</h2>
                        <span class="las la-shopping-cart"></span>
                    </div>
                    <div class="card-progress">
                        <small>Doanh thu trong tháng</small>
                        <div class="card-indicator">
                            <div class="indicator three" style="width: 65%"></div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-head">
                        <h2>47,500</h2>
                        <span class="las la-envelope"></span>
                    </div>
                    <div class="card-progress">
                        <small>Email nhận được</small>
                        <div class="card-indicator">
                            <div class="indicator four" style="width: 90%"></div>
                        </div>
                    </div>
                </div>

            </div>

            <div class="records table-responsive">

                <div class="record-header">
                    <div class="add">
                        <span>Mục</span> <select id="" name="">
                        <option value="">ID</option>
                    </select>

                    </div>

                    <div class="browse">
                        <input class="record-search" placeholder="Search" type="search">
                        <select name="">
                            <option value="">Trạng thái</option>
                        </select>
                    </div>
                </div>

                <div>
                    <table>
                        <thead>
                        <tr>
                            <th><span class="las la-sort"></span>Mã hoá đơn</th>
                            <th><span class="las la-sort"></span> Địa chỉ</th>
                            <th><span class="las la-sort"></span> Số điện thoại</th>
                            <th><span class="las la-sort"></span> Email</th>
                            <th><span class="las la-sort"></span>Tổng tiền</th>
                            <th><span class="las la-sort"></span> Ngày</th>
                            <th><span class="las la-sort"></span> Mã người đặt</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr onclick="check(this)" th:class="'a'+ ${Orders.orderID}" th:each="Orders,idx : ${Orders}">
                            <td>[[${Orders.orderID}]]</td>
                            <td>[[${Orders.address}]]</td>
                            <td>[[${Orders.phone}]]</td>
                            <td>[[${Orders.email}]]</td>
                            <td>[[${Orders.price}]]</td>
                            <td>[[${Orders.date}]]</td>
                            <td>[[${Orders.user.userID}]]</td>
                            <td class="default" th:id="'a'+${Orders.orderID}">
                                <i class="exit fa-solid fa-xmark exitFormOrderDetail"
                                   onclick="exitFormOrderDetail()"></i>
                                <table class="showOrderDetailTable">
                                    <thead>
                                    <tr>
                                        <th><span class="las la-sort"></span> Tên người mua</th>
                                        <th><span class="las la-sort"></span> Tên sản phẩm</th>
                                        <th><span class="las la-sort"></span> Màu sản phẩm</th>
                                        <th><span class="las la-sort"></span> Giá</th>
                                        <th><span class="las la-sort"></span> Số lượng</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr th:each="listOrder, id : ${listOrderDetails.get(idx.index)}">
                                        <td th:text="${Orders.user.username}"></td>
                                        <td th:text="${listOrderDetails.get(idx.index).get(id.index).getProduct().getName()}"></td>
                                        <td th:text="${listOrderDetails.get(idx.index).get(id.index).getColorId().getColor_name()}">
                                            Màu sản phẩm
                                        </td>
                                        <td th:text="${listOrderDetails.get(idx.index).get(id.index).getPrice()}"></td>
                                        <td th:text="${listOrderDetails.get(idx.index).get(id.index).getQuantity()}"></td>
                                    </tr>
                                    </tbody>

                                </table>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <!--                    pagination-->
                    <div id="pagination">
                        <div
                                th:if="${currentPage > 1 }">
                            <a th:class="${Orders == Orders.number } ? ${active} : pagination "
                               th:href="@{${url}(size=${Orders.size}, page=${currentPage - 1} )}"
                            >prev</a>
                        </div>
                        <div
                                th:unless="${currentPage > 1}">
                            <a th:class="${dislabled}">Trang trước</a>
                        </div>
                        <div>
                            <a th:class="${currentPage == 1 } ? ${active} : pagination"
                               th:href="@{${url}(size=${Orders.size}, page=1 )}"
                               th:text="1"
                            ></a>
                        </div>
                        <div th:if="${ 1 < currentPage and currentPage < Orders.totalPages}">
                            <a th:class="${currentPage } ? ${active} "
                               th:href="@{${url}(size=${Orders.size}, page=${currentPage} )}"
                               th:text="${currentPage}"
                            ></a>
                        </div>

                        <div>
                            <a th:class="${currentPage} ?  pagination"
                            >...</a>
                        </div>
                        <div>
                            <a th:class="${currentPage == 4 } ? ${active} : pagination"
                               th:href="@{${url}(size=${Orders.size}, page=${Orders.totalPages} )}"
                               th:text="${Orders.totalPages}"
                            ></a>
                        </div>
                        <div
                                th:if="${Orders.totalPages > currentPage}">
                            <a th:class="${currentPage ==Orders.number} ? ${active} : pagination"
                               th:href="@{${url}(size=${Orders.size}, page=${currentPage+1})}"
                            >Trang sau</a>
                        </div>
                        <div th:unless="${Orders.totalPages > currentPage}">
                            <a th:class="${dislabled}">Trang sau</a>
                        </div>

                    </div>
                </div>
            </div>

        </div>
    </main>

</div>
</body>
<script>
    function check(item) {
        let dv = document.querySelector(".activeTable")
        let lastChildItem = item.lastChild.previousElementSibling;
        let id = item.getAttribute("class")
        let b = document.querySelector(`#${id}`)
        dv != null && dv.classList.remove("activeTable")
        lastChildItem.getAttribute("handleExit") == null ? b.classList.add("activeTable") : lastChildItem.removeAttribute("handleExit")
    }

    const exitFormOrderDetail = () => {
        let dv = document.querySelector(".activeTable")
        dv.classList.remove("activeTable")
        dv.setAttribute("handleExit", "true")
    }
    window.addEventListener("load", () => {
        location.href.includes("/order") && document.querySelector(".oderIcon").setAttribute("style", "color:#fff; scale:1.1")
    })
</script>
</html>